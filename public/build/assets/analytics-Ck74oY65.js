function N(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=Math.random()*16|0,t=e=="x"?n:n&3|8;return t.toString(16)})}function a(e,n){const t=document.getElementById("message");t&&(t.textContent=e,t.className=`message ${n}`,t.classList.remove("hidden"))}let m=localStorage.getItem("guest_uuid");m||(m=N(),localStorage.setItem("guest_uuid",m));const _=document.getElementById("guestUuidDisplay");_&&(_.textContent=m);let h=parseInt(localStorage.getItem("page_views")||"0"),p=parseInt(localStorage.getItem("screen_time")||"0"),g=parseInt(localStorage.getItem("session_time")||"0"),f=parseInt(localStorage.getItem("click_count")||"0"),y=parseInt(localStorage.getItem("js_error_count")||"0"),k=localStorage.getItem("traffic_source")||document.referrer||"direct",I=0;function d(){const e={pageViewsDisplay:h,screenTimeDisplay:p,sessionTimeDisplay:g,clickCountDisplay:f,trafficSourceDisplay:k,jsErrorsDisplay:y,scrollDepthDisplay:`${I}%`};for(const n in e){const t=document.getElementById(n);t&&(t.textContent=e[n])}}d();h++;localStorage.setItem("page_views",h);d();let C,b;function A(){C=setInterval(()=>{p++,localStorage.setItem("screen_time",p),d()},1e3),b=setInterval(()=>{g++,localStorage.setItem("session_time",g),d()},1e3)}function j(){clearInterval(C),clearInterval(b)}document.addEventListener("click",()=>{f++,localStorage.setItem("click_count",f),d()});const u=document.querySelector(".scrollable-content");u&&u.addEventListener("scroll",()=>{const e=u.scrollTop,n=u.scrollHeight,t=u.clientHeight;if(n>t){const o=Math.floor(e/(n-t)*100);o>I&&(I=o,d())}});const w=document.getElementById("sampleInput");w&&(w.addEventListener("focus",()=>{console.log("Input Focused"),r("[INT]_input_focus",{elementId:"sampleInput"})}),w.addEventListener("blur",()=>{console.log("Input Blurred"),r("[INT]_input_blur",{elementId:"sampleInput"})}));document.addEventListener("copy",e=>{const n=e.clipboardData.getData("text/plain");console.log("Text Copied:",n.substring(0,Math.min(n.length,50))+(n.length>50?"...":"")),r("[INT]_text_copied",{text_length:n.length})});let E;window.addEventListener("resize",()=>{clearTimeout(E),E=setTimeout(()=>{console.log("Window Resized:",window.innerWidth,"x",window.innerHeight),r("[INT]_window_resized",{width:window.innerWidth,height:window.innerHeight})},500)});window.onerror=(e,n,t,o,i)=>(y++,localStorage.setItem("js_error_count",y),d(),console.error("JS Error Captured:",e,n,t,o,i),r("[INT]_js_error",{message:e,source:n,lineno:t,colno:o,error_stack:i?i.stack:"N/A"}),!1);document.querySelectorAll(".addToCartBtn").forEach(e=>{e.addEventListener("click",n=>{const t=n.target.dataset.productId;console.log(`Product ${t} added to cart.`),r("[INT]_add_to_cart",{product_id:t})})});document.querySelectorAll(".removeFromCartBtn").forEach(e=>{e.addEventListener("click",n=>{const t=n.target.dataset.productId;console.log(`Product ${t} removed from cart.`),r("[INT]_remove_from_cart",{product_id:t})})});const T=document.getElementById("internalSearchInput"),S=document.getElementById("searchBtn");S&&T&&S.addEventListener("click",()=>{const e=T.value;e&&(console.log("Internal Search:",e),r("[INT]_internal_search",{search_query:e}))});function L(){const e=navigator.userAgent;let n="Desktop";/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?n="Tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Source|Jasmine|Blazer|Opera Mini|CriOS|Firefox|FxiOS/i.test(e)&&(n="Mobile");let t="Unknown OS";e.indexOf("Win")!=-1&&(t="Windows"),e.indexOf("Mac")!=-1&&(t="macOS"),e.indexOf("Linux")!=-1&&(t="Linux"),e.indexOf("Android")!=-1&&(t="Android"),(e.indexOf("iOS")!=-1||/(iPhone|iPad|iPod)/i.test(e))&&(t="iOS");let o="Unknown Browser";return e.indexOf("Chrome")!=-1&&!e.includes("Edg")&&!e.includes("OPR")?o="Chrome":e.indexOf("Firefox")!=-1?o="Firefox":e.indexOf("Safari")!=-1&&!e.includes("Chrome")?o="Safari":e.indexOf("Edg")!=-1?o="Edge":e.indexOf("Opera")!=-1||e.indexOf("OPR")!=-1?o="Opera":(e.indexOf("MSIE")!=-1||e.indexOf("Trident")!=-1)&&(o="IE"),{deviceType:n,os:t,browser:o,resolution:`${window.screen.width}x${window.screen.height}`}}const x=L(),v=document.getElementById("deviceTypeDisplay"),D=document.getElementById("osDisplay"),B=document.getElementById("browserDisplay"),O=document.getElementById("resolutionDisplay");v&&(v.textContent=x.deviceType);D&&(D.textContent=x.os);B&&(B.textContent=x.browser);O&&(O.textContent=x.resolution);window.addEventListener("load",()=>{const e=window.performance.timing,n=e.loadEventEnd-e.navigationStart,t=document.getElementById("pageLoadTimeDisplay");t&&(t.textContent=`${n}ms`),r("[INT]_page_load_time",{load_time_ms:n})});async function r(e="[INT]_update_session",n={}){const t={guest_uuid:m,eventName:e,eventData:{session_duration:g,...n},screenData:{_int_href:window.location.href,_int_pathname:window.location.pathname,_int_hash:window.location.hash,_int_search:window.location.search},currentUrl:window.location.href,pageTitle:document.title,trafficSource:k,screenViews:h,screenTime:p,sessionTime:g,scrollDepth:I,deviceInfo:L(),performanceMetrics:{page_load_time_ms:window.performance.timing.loadEventEnd-window.performance.timing.navigationStart},interactionDetails:{click_count:f,js_error_count:y}};e==="[INT]_internal_search"&&n.search_query&&(t.searchQuery=n.search_query);try{const o=await fetch("/api/analytics/track",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(t)}),i=await o.json();if(!o.ok)throw new Error(i.message||"خطا در ارسال داده‌های تحلیلی");console.log("Analytics data sent:",i.message)}catch(o){console.error("Error sending analytics data:",o)}}window.onload=A;window.addEventListener("beforeunload",()=>{j(),r("[INT]_session_end")});setInterval(r,3e4);document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("loginBtn"),n=document.getElementById("logoutBtn"),t=document.getElementById("getUserBtn"),o=document.getElementById("generateErrorBtn");e&&e.addEventListener("click",async()=>{const i=document.getElementById("email").value,l=document.getElementById("password").value;try{const s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({email:i,password:l})}),c=await s.json();s.ok?a(c.message,"success"):a(c.message,"error")}catch(s){a("خطا در ورود: "+s.message,"error")}}),n&&n.addEventListener("click",async()=>{try{const i=await fetch("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}),l=await i.json();if(i.ok){a(l.message,"success");const s=document.getElementById("userInfo"),c=document.getElementById("userData");s&&s.classList.add("hidden"),c&&(c.textContent="")}else a(l.message,"error")}catch(i){a("خطا در خروج: "+i.message,"error")}}),t&&t.addEventListener("click",async()=>{try{const i=await fetch("/api/user",{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}),l=await i.json(),s=document.getElementById("userInfo"),c=document.getElementById("userData");i.ok?(c&&(c.textContent=JSON.stringify(l,null,2)),s&&s.classList.remove("hidden"),a("اطلاعات کاربر با موفقیت دریافت شد.","success")):(a(l.message||"خطا در دریافت اطلاعات کاربر","error"),s&&s.classList.add("hidden"))}catch(i){a("خطا در دریافت اطلاعات کاربر: "+i.message,"error")}}),o&&o.addEventListener("click",()=>{console.log(undefinedVariable.property)})});
//# sourceMappingURL=analytics-Ck74oY65.js.map
