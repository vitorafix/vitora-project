import{g as h,f as p,c as L,l as f}from"./auth-modules-Tx9inXK_.js";function v(s,e){let t;return function(...o){const a=this;clearTimeout(t),t=setTimeout(()=>s.apply(a,o),e)}}console.log("navbar_new.js loaded and starting...");async function m(){const s=h(),e=document.getElementById("desktop-user-status-display"),t=document.getElementById("user-status-guest"),o=document.getElementById("user-status-logged-in"),a=document.getElementById("logged-in-user-full-name"),i=document.getElementById("login-register-link"),l=document.getElementById("mobile-user-status-guest"),r=document.getElementById("mobile-user-status-logged-in"),c=document.getElementById("mobile-logged-in-user-name"),u=document.getElementById("mobile-logged-in-user-mobile");if(console.log("DEBUG: updateNavbarUserStatus - Function called."),console.log("DEBUG: updateNavbarUserStatus - JWT Token in localStorage:",s?"Found":"Not Found",s),s){console.log("DEBUG: updateNavbarUserStatus - JWT Token found. Attempting to fetch user data.");try{const n=await p(),d=`${n.name||""} ${n.lastname||""}`.trim();console.log("DEBUG: updateNavbarUserStatus - User data fetched:",n),e&&(e.textContent=`سلام، ${n.name||n.mobile_number}`,console.log("DEBUG: desktopUserStatusDisplay updated to:",e.textContent)),t&&(t.classList.add("hidden"),console.log("DEBUG: userStatusGuestDiv hidden. ClassList:",t.classList.toString())),o&&(o.classList.remove("hidden"),console.log("DEBUG: userStatusLoggedInDiv shown. ClassList:",o.classList.toString()),a&&(a.textContent=d,console.log("DEBUG: loggedInUserFullNameDesktop updated to:",a.textContent))),i&&(i.classList.add("hidden"),console.log("DEBUG: loginRegisterLink hidden. ClassList:",i.classList.toString())),l&&(l.classList.add("hidden"),console.log("DEBUG: mobileUserStatusGuestDiv hidden. ClassList:",l.classList.toString())),r&&(r.classList.remove("hidden"),console.log("DEBUG: mobileUserStatusLoggedInDiv shown. ClassList:",r.classList.toString()),c&&(c.textContent=d,console.log("DEBUG: mobileLoggedInUserName updated to:",c.textContent)),u&&(u.textContent=n.mobile_number,console.log("DEBUG: mobileLoggedInUserMobile updated to:",u.textContent))),document.querySelectorAll(".nav-link-dropdown-compact.text-red-500").forEach(g=>{g.classList.remove("hidden"),console.log("DEBUG: Logout button shown:",g)}),console.log("Navbar user status updated: Logged in as",d||n.mobile_number)}catch(n){console.error("Error fetching user data with JWT. Treating as guest:",n),n.response&&n.response.status===401&&(L(),console.log("JWT token cleared due to 401 Unauthorized.")),e&&(e.textContent="کاربر مهمان",console.log("DEBUG: desktopUserStatusDisplay updated to:",e.textContent)),o&&(o.classList.add("hidden"),console.log("DEBUG: userStatusLoggedInDiv hidden. ClassList:",o.classList.toString())),t&&(t.classList.remove("hidden"),console.log("DEBUG: userStatusGuestDiv shown. ClassList:",t.classList.toString())),i&&(i.classList.remove("hidden"),console.log("DEBUG: loginRegisterLink shown. ClassList:",i.classList.toString())),r&&(r.classList.add("hidden"),console.log("DEBUG: mobileUserStatusLoggedInDiv hidden. ClassList:",r.classList.toString())),l&&(l.classList.remove("hidden"),console.log("DEBUG: mobileUserStatusGuestDiv shown. ClassList:",l.classList.toString())),document.querySelectorAll(".nav-link-dropdown-compact.text-red-500").forEach(d=>{d.classList.add("hidden"),console.log("DEBUG: Logout button hidden:",d)}),console.log("Navbar user status updated: Guest user (due to error or no token).")}}else console.log("DEBUG: updateNavbarUserStatus - No JWT Token found. Displaying guest state."),e&&(e.textContent="ورود / ثبت‌نام",console.log("DEBUG: desktopUserStatusDisplay updated to:",e.textContent)),o&&(o.classList.add("hidden"),console.log("DEBUG: userStatusLoggedInDiv hidden. ClassList:",o.classList.toString())),t&&(t.classList.remove("hidden"),console.log("DEBUG: userStatusGuestDiv shown. ClassList:",t.classList.toString())),i&&(i.classList.remove("hidden"),console.log("DEBUG: loginRegisterLink shown. ClassList:",i.classList.toString())),r&&(r.classList.add("hidden"),console.log("DEBUG: mobileUserStatusLoggedInDiv hidden. ClassList:",r.classList.toString())),l&&(l.classList.remove("hidden"),console.log("DEBUG: mobileUserStatusGuestDiv shown. ClassList:",l.classList.toString())),document.querySelectorAll(".nav-link-dropdown-compact.text-red-500").forEach(n=>{n.classList.add("hidden"),console.log("DEBUG: Logout button hidden:",n)}),console.log("Navbar user status updated: Guest user (no token).")}function b(){console.log("DEBUG: initializeNavbarAndCart function called."),m();const s=document.querySelectorAll(".nav-link-dropdown-compact.text-red-500");s.length>0?s.forEach(e=>{e.addEventListener("click",async function(t){t.preventDefault(),console.log("DEBUG: Logout button clicked. Initiating logout process.");try{await f(),console.log("DEBUG: Logout initiated. Redirection expected from api.js.")}catch(o){console.error("Error during logout in navbar_new.js:",o),window.showMessage("خطا در خروج از حساب کاربری.","error")}}),console.log("DEBUG: Attached logout listener to:",e)}):console.warn('No logout buttons found with selector ".nav-link-dropdown-compact.text-red-500" during navbar initialization.')}const y=Object.freeze(Object.defineProperty({__proto__:null,initializeNavbarAndCart:b,updateNavbarUserStatus:m},Symbol.toStringTag,{value:"Module"}));function E(s){const e=document.getElementById("search-results-container");if(!e){console.error("Search results container not found.");return}if(e.innerHTML="",e.classList.remove("hidden"),s.length===0){e.innerHTML=`
            <p class="text-gray-500 p-4 text-center text-sm">محصولی یافت نشد.</p>
        `;return}s.forEach(t=>{const o=document.createElement("a");o.href=`/products/${t.id}`,o.classList.add("flex","items-center","p-4","border-b","border-gray-200","last:border-b-0","hover:bg-gray-50","transition-colors","duration-200","rounded-lg","cursor-pointer");const a=t.image||"https://placehold.co/100x100/A7F3D0/10B981?text=No+Image";o.innerHTML=`
            <img src="${a}"
                 onerror="this.onerror=null;this.src='https://placehold.co/100x100/E5E7EB/4B5563?text=No+Image';"
                 alt="${t.title}"
                 class="w-16 h-16 rounded-lg object-cover ml-4 shadow-sm">
            <div class="flex-1">
                <h3 class="text-lg font-semibold text-green-700">${t.title}</h3>
                <p class="text-gray-600 text-sm mt-1">${t.description?t.description.substring(0,80)+"...":""}</p>
                <p class="text-amber-600 font-bold mt-2">${new Intl.NumberFormat("fa-IR").format(t.price)} تومان</p>
            </div>
        `,e.appendChild(o)})}function U(){console.log("Search module initializing...");const s=document.getElementById("live-search-input"),e=document.getElementById("search-results-container");if(!s||!e){console.warn("Search elements not found. Skipping live search initialization.");return}s.addEventListener("input",v(async function(){var o,a;const t=this.value.trim();if(t.length<2){e.classList.add("hidden"),e.innerHTML='<p class="text-gray-500 text-center py-4 text-sm" id="initial-message">شروع به تایپ کنید تا نتایج را مشاهده کنید.</p>';return}e.innerHTML='<p class="text-center py-4 text-green-600"><i class="fas fa-spinner fa-spin ml-2"></i>در حال جستجو...</p>',e.classList.remove("hidden");try{const l=(await window.axios.get(`/search?q=${encodeURIComponent(t)}`)).data;E(l)}catch(i){console.error("Search error:",i);const l=((a=(o=i.response)==null?void 0:o.data)==null?void 0:a.message)||"خطا در ارتباط با سرور. لطفا اتصال اینترنت خود را بررسی کنید.";typeof window.showMessage=="function"&&window.showMessage(l,"error"),e.innerHTML='<p class="text-red-500 p-4 text-center">خطا در ارتباط با سرور</p>',e.classList.remove("hidden")}},300)),document.addEventListener("click",t=>{t.target!==s&&!e.contains(t.target)&&e.classList.add("hidden")}),s.addEventListener("focus",()=>{s.value.trim().length>0?(e.children.length>0&&e.firstElementChild.id!=="initial-message"||(s.value.trim().length<2?e.innerHTML='<p class="text-gray-500 text-center py-4 text-sm" id="initial-message">شروع به تایپ کنید تا نتایج را مشاهده کنید.</p>':s.dispatchEvent(new Event("input"))),e.classList.remove("hidden")):(e.innerHTML='<p class="text-gray-500 text-center py-4 text-sm" id="initial-message">شروع به تایپ کنید تا نتایج را مشاهده کنید.</p>',e.classList.remove("hidden"))}),console.log("Search module initialized successfully.")}const B=Object.freeze(Object.defineProperty({__proto__:null,initSearch:U},Symbol.toStringTag,{value:"Module"}));function S(){const s=document.querySelectorAll(".hero-slide");if(s.length===0){console.warn("No hero slides found. Hero carousel will not be initialized.");return}console.log("Hero carousel initialized with",s.length,"slides.")}const x=Object.freeze(Object.defineProperty({__proto__:null,initHeroCarousel:S},Symbol.toStringTag,{value:"Module"}));export{x as h,y as n,B as s,m as u};
//# sourceMappingURL=ui-components-uVfRm-cR.js.map
