const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/auth-modules-Tx9inXK_.js","assets/vendor-axios-xsH4HHeE.js","assets/ui-components-uVfRm-cR.js","assets/admin-panel-DfTYWkpc.js","assets/vendor-DZtHqBjz.js"])))=>i.map(i=>d[i]);
import{a as x,l as v}from"./auth-modules-Tx9inXK_.js";import{m as y,a as E}from"./vendor-DZtHqBjz.js";import"./analytics-Ck74oY65.js";import"./vendor-axios-xsH4HHeE.js";import"./ui-components-uVfRm-cR.js";const b="modulepreload",w=function(t){return"/build/"+t},h={},g=function(e,a,s){let n=Promise.resolve();if(a&&a.length>0){let c=function(l){return Promise.all(l.map(o=>Promise.resolve(o).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));n=c(a.map(l=>{if(l=w(l),l in h)return;h[l]=!0;const o=l.endsWith(".css"),m=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":b,o||(u.as="script"),u.crossOrigin="",u.href=l,i&&u.setAttribute("nonce",i),document.head.appendChild(u),o)return new Promise((f,p)=>{u.addEventListener("load",f),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function d(c){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=c,window.dispatchEvent(r),!r.defaultPrevented)throw c}return n.then(c=>{for(const r of c||[])r.status==="rejected"&&d(r.reason);return e().catch(d)})};window.axios=x;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";console.log("renderer.js loaded and starting...");const C={setCartLoadingState:function(t){const e=document.getElementById("mini-cart-toggle"),a=document.getElementById("cart-page-container");e&&(t?e.classList.add("opacity-50","pointer-events-none"):e.classList.remove("opacity-50","pointer-events-none")),a&&(t?a.classList.add("opacity-50","pointer-events-none"):a.classList.remove("opacity-50","pointer-events-none")),console.log("Cart loading state set to:",t)},renderMainCart:function(t,e){console.log("renderMainCart: Function called."),console.log("renderMainCart: Received items:",t),console.log("renderMainCart: Received cartTotals:",e),console.log("renderMainCart: Is items array an array?",Array.isArray(t)),console.log("renderMainCart: Items array length:",t?t.length:"N/A");const a=document.getElementById("cart-items-container"),s=document.getElementById("cart-empty-message"),n=document.getElementById("cart-summary"),d=document.getElementById("cart-total-price"),c=document.getElementById("cart-subtotal-price"),r=document.getElementById("cart-discount-price"),i=document.getElementById("cart-shipping-price"),l=document.getElementById("cart-tax-price");if(!a||!s||!n||!d||!c||!r||!i||!l){console.warn("One or more main cart DOM elements not found. Skipping main cart rendering."),console.warn("Missing elements:",{cartItemsContainer:!!a,cartEmptyMessage:!!s,cartSummary:!!n,cartTotalPriceElement:!!d,cartSubtotalPriceElement:!!c,cartDiscountPriceElement:!!r,cartShippingPriceElement:!!i,cartTaxPriceElement:!!l});return}if(a.innerHTML="",!Array.isArray(t)||t.length===0){console.log("renderMainCart: Condition for empty cart met. Displaying empty message."),s.classList.remove("hidden"),a.classList.add("hidden"),n.classList.add("hidden"),c.textContent="0 تومان",r.textContent="0 تومان",i.textContent="0 تومان",l.textContent="0 تومان",d.textContent="0 تومان";return}console.log("renderMainCart: Cart is NOT empty. Proceeding to render items."),s.classList.add("hidden"),a.classList.remove("hidden"),n.classList.remove("hidden"),t.forEach((o,m)=>{console.log(`renderMainCart: Processing item ${m+1}:`,o);const u=document.createElement("div");u.classList.add("flex","items-center","justify-between","py-4","border-b","border-gray-200","last:border-b-0"),u.setAttribute("data-cart-item-id",o.id),u.setAttribute("data-unit-price",o.unitPrice&&!isNaN(o.unitPrice)?o.unitPrice:0);const f=o.product&&o.product.image?o.product.image:"https://placehold.co/100x100/E5E7EB/4B5563?text=No+Image",p=o.product.name||"نامشخص";u.innerHTML=`
                <div class="flex items-center flex-grow">
                    <img src="${f}" 
                         onerror="this.onerror=null;this.src='https://placehold.co/100x100/E5E7EB/4B5563?text=No+Image';"
                         alt="${p}" 
                         class="w-20 h-20 rounded-lg object-cover ml-4 shadow-sm">
                    <div class="flex-grow">
                        <h3 class="text-lg font-semibold text-gray-800">${p}</h3>
                        ${o.product_variant?`<p class="text-sm text-gray-500">نوع: ${o.product_variant.name}</p>`:""}
                        <p class="text-green-700 font-bold mt-1">${new Intl.NumberFormat("fa-IR").format(o.unitPrice)} تومان</p>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="flex items-center border border-gray-300 rounded-md overflow-hidden ml-4">
                        <button class="quantity-btn p-2 bg-gray-100 hover:bg-gray-200" data-action="decrease" data-cart-item-id="${o.id}">
                            <i class="fas fa-minus text-gray-600"></i>
                        </button>
                        <!-- تغییر از span به input برای قابلیت ویرایش و خواندن مقدار -->
                        <input type="text" value="${o.quantity}" class="w-12 text-center border-x border-gray-300 py-2 focus:outline-none bg-white dark:bg-gray-700 dark:text-white item-quantity" readonly>
                        <button class="quantity-btn p-2 bg-gray-100 hover:bg-gray-200" data-action="increase" data-cart-item-id="${o.id}">
                            <i class="fas fa-plus text-gray-600"></i>
                        </button>
                    </div>
                    <p class="text-gray-800 font-semibold ml-4 item-subtotal" data-subtotal="${o.totalPrice}">${new Intl.NumberFormat("fa-IR").format(o.totalPrice)} تومان</p>
                    <button class="remove-item-btn p-2 text-red-500 hover:text-red-700 transition-colors duration-200" data-cart-item-id="${o.id}">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `,a.appendChild(u),console.log(`renderMainCart: Appended item ${o.id} to cartItemsContainer.`)}),c.textContent=new Intl.NumberFormat("fa-IR").format(e.subtotal??0)+" تومان",r.textContent=new Intl.NumberFormat("fa-IR").format(e.discount??0)+" تومان",i.textContent=new Intl.NumberFormat("fa-IR").format(e.shipping??0)+" تومان",l.textContent=new Intl.NumberFormat("fa-IR").format(e.tax??0)+" تومان",d.textContent=new Intl.NumberFormat("fa-IR").format(e.totalPrice??0)+" تومان",console.log("Main cart totals updated. Total price:",d.textContent),console.log("Main cart rendered successfully.")},renderMiniCartDetails:function(t,e,a){console.log("renderMiniCartDetails called with items:",t,"totalQuantity:",e,"totalPrice:",a);const s=document.getElementById("mini-cart-items-container"),n=document.getElementById("mini-cart-total-quantity"),d=document.getElementById("mini-cart-total-price"),c=document.getElementById("mini-cart-empty-message"),r=document.getElementById("mini-cart-summary");if(!s||!n||!d||!c||!r){console.warn("One or more mini cart DOM elements not found. Skipping mini cart rendering.");return}if(s.innerHTML="",!Array.isArray(t)||t.length===0){c.classList.remove("hidden"),s.classList.add("hidden"),r.classList.add("hidden"),n.classList.add("hidden"),n.textContent="0",d.textContent="0 تومان",console.log("Mini cart is empty. Displaying empty message.");return}c.classList.add("hidden"),s.classList.remove("hidden"),r.classList.remove("hidden"),n.classList.remove("hidden"),t.forEach(i=>{const l=document.createElement("div");l.classList.add("flex","items-center","py-2","border-b","border-gray-100","last:border-b-0"),l.setAttribute("data-cart-item-id",i.id);const o=i.product&&i.product.image?i.product.image:"https://placehold.co/50x50/E5E7EB/4B5563?text=No+Image",m=i.product.name||"نامشخص";l.innerHTML=`
                <img src="${o}" 
                     onerror="this.onerror=null;this.src='https://placehold.co/50x50/E5E7EB/4B5563?text=No+Image';"
                     alt="${m}" 
                     class="w-12 h-12 rounded-md object-cover ml-3">
                <div class="flex-grow">
                    <p class="text-sm font-medium text-gray-800">${m}</p>
                    ${i.product_variant?`<p class="text-xs text-gray-500">نوع: ${i.product_variant.name}</p>`:""}
                    <!-- تغییر در اینجا: "تعداد:" را از داخل span خارج کردیم -->
                    <p class="text-xs text-gray-600">تعداد: <span class="mini-cart-item-quantity" data-quantity="${i.quantity}">${i.quantity}</span></p>
                </div>
                <p class="text-sm font-bold text-green-700 mini-cart-item-subtotal" data-subtotal="${i.totalPrice}">${new Intl.NumberFormat("fa-IR").format(i.totalPrice)} تومان</p>
            `,s.appendChild(l)}),n.textContent=e,d.textContent=new Intl.NumberFormat("fa-IR").format(a)+" تومان",console.log("Mini cart rendered successfully.")}};typeof window<"u"&&(window.CartRenderer=C,console.log("CartRenderer exposed globally for debugging."));console.log("app.js loaded and starting...");window.Alpine=y;y.start();window.jalaali=E;window.adminActivityLog=[{timestamp:new Date,username:"سیستم",action:"راه‌اندازی پنل",details:"سیستم آماده کار است."}];window.currentUser={id:1,username:"admin",role:"مدیر",lastLocation:"192.168.1.100"};window.showMessage=function(t,e="info",a=3e3){const s=document.querySelector(".message-box");s&&s.remove();const n=document.createElement("div");n.className="fixed bottom-5 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg text-white z-50 transition-all duration-300 ease-out message-box",e==="success"?n.classList.add("bg-green-600"):e==="error"?n.classList.add("bg-red-600"):n.classList.add("bg-gray-800"),n.textContent=t,document.body.appendChild(n),setTimeout(()=>{n.classList.add("opacity-0","translate-y-full"),n.addEventListener("transitionend",()=>n.remove())},a)};window.showConfirmationModal=function(t,e,a,s){const n=document.getElementById("confirm-modal-overlay");if(!n){console.error("Confirmation modal overlay not found. Ensure 'confirm-modal-overlay' element exists in your layout.");return}const d=n.querySelector("h3"),c=n.querySelector("p#confirm-message");let r=n.querySelector("#confirm-yes"),i=n.querySelector("#confirm-no");r.replaceWith(r.cloneNode(!0)),i.replaceWith(i.cloneNode(!0)),r=n.querySelector("#confirm-yes"),i=n.querySelector("#confirm-no"),d.textContent=t,c.textContent=e,n.classList.remove("hidden"),n.classList.add("active");const l=()=>{a(),n.classList.add("hidden"),n.classList.remove("active")},o=()=>{s&&s(),n.classList.add("hidden"),n.classList.remove("active")};r.addEventListener("click",l),i.addEventListener("click",o)};window.logAdminAction=function(t,e,a){window.adminActivityLog.push({timestamp:new Date,username:t,action:e,details:a})};function I(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function _(t,e,a){let s="";{const n=new Date;n.setTime(n.getTime()+a*24*60*60*1e3),s="; expires="+n.toUTCString()}document.cookie=t+"="+(e||"")+s+"; path=/"}function L(){let t=localStorage.getItem("guest_uuid");return t?console.log("Existing guest_uuid retrieved:",t):(t=I(),localStorage.setItem("guest_uuid",t),console.log("New guest_uuid generated and stored:",t)),_("guest_uuid",t,365),t}function P(){const t=document.getElementById("current-gallery-images");t&&(console.log("Product edit page detected. Setting up gallery image listeners."),t.addEventListener("click",function(e){if(e.target.closest(".remove-gallery-image-btn")){const a=e.target.closest(".remove-gallery-image-btn"),s=a.dataset.imageId,n=a.closest(".relative.group");window.showConfirmationModal("حذف تصویر","آیا مطمئن هستید که می‌خواهید این تصویر را حذف کنید؟",()=>{const d=n.querySelector(".remove-image-input");d&&(d.value=s,n.style.display="none",window.showMessage("تصویر برای حذف علامت‌گذاری شد.","success"))},()=>{window.showMessage("عملیات حذف تصویر لغو شد.","info")})}}))}window.guest_uuid=L();document.addEventListener("DOMContentLoaded",()=>{const t=window.location.pathname;(t.includes("/login")||t.includes("/register")||t.includes("/profile")||t.includes("/dashboard")||t.includes("/mobile-login")||t.includes("/verify-otp-form"))&&(g(()=>import("./auth-modules-Tx9inXK_.js").then(e=>e.h),__vite__mapDeps([0,1,2])).then(e=>{e.initAuth&&e.initAuth(),console.log("Auth module loaded and initialized.")}).catch(e=>console.error("Failed to load auth module:",e)),g(()=>import("./auth-modules-Tx9inXK_.js").then(e=>e.j),__vite__mapDeps([0,1,2])).then(()=>{console.log("JWT Manager module loaded.")}).catch(e=>console.error("Failed to load JWT Manager module:",e))),(t.includes("/search")||t.includes("/products"))&&g(()=>import("./ui-components-uVfRm-cR.js").then(e=>e.s),__vite__mapDeps([2,0,1])).then(e=>{e.initSearch?e.initSearch():console.warn("Search module loaded but initSearch function not found."),console.log("Search module loaded and initialized.")}).catch(e=>console.error("Failed to load search module:",e)),(document.querySelector("#main-navbar")||document.querySelector(".main-nav"))&&g(()=>import("./ui-components-uVfRm-cR.js").then(e=>e.n),__vite__mapDeps([2,0,1])).then(e=>{e.initializeNavbarAndCart?e.initializeNavbarAndCart():console.warn("Navbar module loaded but initializeNavbarAndCart function not found."),console.log("Navbar module loaded and initialized.")}).catch(e=>console.error("Failed to load navbar module:",e)),t.startsWith("/admin/")&&g(()=>import("./admin-panel-DfTYWkpc.js").then(e=>e.a),__vite__mapDeps([3,4])).then(e=>{e.initAdminPanel?e.initAdminPanel():console.warn("Admin module loaded but initAdminPanel function not found."),console.log("Admin module loaded and initialized.")}).catch(e=>console.error("Failed to load admin module:",e)),(t.includes("/dashboard")||t.includes("/admin-reports")||t.includes("/analytics"))&&g(()=>import("./admin-panel-DfTYWkpc.js").then(e=>e.c),__vite__mapDeps([3,4])).then(e=>{e.initCharts?e.initCharts():console.warn("Charts module loaded but initCharts function not found."),console.log("Charts module loaded and initialized.")}).catch(e=>console.error("Failed to load charts module:",e)),t.includes("/checkout")&&g(()=>import("./payment-system-BGXqsU2m.js"),[]).then(e=>{e.initCheckout?e.initCheckout():console.warn("Checkout module loaded but initCheckout function not found."),console.log("Checkout module loaded and initialized.")}).catch(e=>console.error("Failed to load checkout module:",e)),(t==="/"||t.includes("/home"))&&g(()=>import("./ui-components-uVfRm-cR.js").then(e=>e.h),__vite__mapDeps([2,0,1])).then(e=>{e.initHeroCarousel?e.initHeroCarousel():console.warn("Hero module loaded but initHeroCarousel function not found."),console.log("Hero module loaded and initialized.")}).catch(e=>console.error("Failed to load hero module:",e)),(document.getElementById("export-excel")||document.getElementById("export-pdf"))&&g(()=>import("./shopping-cart-DZ68Slzt.js"),[]).then(e=>{e.setupExportButtons?e.setupExportButtons():console.warn("Export module loaded but setupExportButtons function not found."),console.log("Export module loaded and initialized.")}).catch(e=>console.error("Failed to load export module:",e)),(t.includes("/products/edit")||t.includes("/products/create"))&&(P(),console.log("Product edit listeners setup."))});window.logoutUser=v;
//# sourceMappingURL=app-B8fVK6C8.js.map
