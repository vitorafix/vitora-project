function g(){const c=document.getElementById("export-excel");c&&c.addEventListener("click",()=>{if(typeof XLSX>"u"){typeof window.showMessage=="function"?window.showMessage("خطا: کتابخانه XLSX برای صادرات اکسل یافت نشد.","error"):console.error("Error: XLSX library not found for Excel export.");return}const i=[["نام محصول","قیمت","موجودی"],["چای سیاه",5e4,1e3],["چای سبز",6e4,500],["چای ارل گری",75e3,300]],s=XLSX.utils.aoa_to_sheet(i),e=XLSX.utils.book_new();XLSX.utils.book_append_sheet(e,s,"گزارش محصولات"),XLSX.writeFile(e,"گزارش_محصولات.xlsx"),typeof window.showMessage=="function"?window.showMessage("فایل اکسل با موفقیت صادر شد.","success"):console.log("فایل اکسل با موفقیت صادر شد.")});const a=document.getElementById("export-pdf");a&&a.addEventListener("click",async()=>{if(typeof window.jspdf>"u"||typeof html2canvas>"u"){typeof window.showMessage=="function"?window.showMessage("خطا: کتابخانه‌های jspdf یا html2canvas برای صادرات PDF یافت نشدند.","error"):console.error("Error: jspdf or html2canvas libraries not found for PDF export.");return}const{jsPDF:i}=window.jspdf,s=new i,e=document.getElementById("reports-content");if(!e){typeof window.showMessage=="function"?window.showMessage("محتوای گزارش برای تولید PDF یافت نشد.","error"):console.log("محتوای گزارش برای تولید PDF یافت نشد.");return}const l=e.classList.contains("hidden")||!e.classList.contains("active");l&&(e.style.display="block",e.classList.add("temp-visible-for-pdf"));try{const o=await html2canvas(e,{scale:2,useCORS:!0,windowWidth:document.body.scrollWidth,windowHeight:document.body.scrollHeight}),w=o.toDataURL("image/png"),d=210,f=297,t=o.height*d/o.width;let n=t,r=0;for(s.addImage(w,"PNG",0,r,d,t),n-=f;n>0;)r=n-t,s.addPage(),s.addImage(w,"PNG",0,r,d,t),n-=f;s.save("گزارش.pdf"),typeof window.showMessage=="function"?window.showMessage("فایل PDF با موفقیت صادر شد.","success"):console.log("فایل PDF با موفقیت صادر شد.")}catch(o){console.error("Error generating PDF:",o),typeof window.showMessage=="function"?window.showMessage("خطا در تولید PDF: "+o.message,"error"):console.log("خطا در تولید PDF: "+o.message)}finally{l&&(e.style.display="",e.classList.remove("temp-visible-for-pdf"))}})}export{g as setupExportButtons};
//# sourceMappingURL=shopping-cart-DZ68Slzt.js.map
